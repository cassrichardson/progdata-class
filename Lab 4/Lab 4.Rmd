---
title: "Lab 4"
author: "Cassandra Richardson"
date: "2/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(dplyr)
library(gapminder)

dictionary <- readr::read_csv(here::here("data", "green_dictionary.csv"))
green_data <- readr::read_csv(here::here("data", "green_data.csv")) 
```

# 1. Inspect the item responses (e.g., with graphs or by summarizing distinct values). Is there anything unusual?

```{r examining data}
View(green_data)
View(dictionary)
```

## Through looking at the scales in the dictionary, I realized that some of the variables are coded as -1, meaning that they will need to be reverse-coded before conducting analyses. 

``` {r reverse coding}
reversed <- c("green2", "comp6", "comp7", "comp8", "comp9", "comp10", "intel7", "intel8", "intel9", "intel10", "open7", "open8", "open9", "open10")

green_data_fix <- green_data |>
  mutate_all(na_if, -99)
  
green_data_recoded <- green_data_fix |>
  mutate(across(
    all_of(reversed),
    \(x) recode(x, "5" = 1, "4" = 2, "3" = 3, "2" = 4, "1" = 5, "-99" = NA_real_))) 

View(green_data_recoded)
```

# 2. Compute total scores for the four scales. 

``` {r scale scores}
summary(green_data_recoded)

green_total_scores <- green_data_recoded |>
  rowwise() |>
  mutate(
    id = id, 
    green_total = mean(c_across(green1:green5), na.rm = T),
    compassion_total = mean(c_across(comp1:comp10), na.rm = T),
    openness_total = mean(c_across(open1:open10), na.rm = T),
    intel_total = mean(c_across(intel1:intel10), na.rm = T),
    .before = everything())
```
# 3. Rescale variables to be 0-100 instead of original scales. Name these variables *_pomp

```{r rescale}
green_data_rescaled <- green_total_scores |>
  mutate(
    across(green_total:intel_total,
    \(x) 100 * (x-1)/(5-1),
    .names = "{.col}_pomp"), 
    .before = everything())
```

# 4. Make plots for the distributions of the 4 pomp-scored variables

## Histogram for total score on green reputation: 

```{r plots}
ggplot(green_data_rescaled) + 
  aes (x = green_total_pomp) +
  geom_histogram(binwidth = 1)
```

## Histogram for total score on compassion:

```{r plots}
ggplot(green_data_rescaled) + 
  aes (x = compassion_total_pomp) +
  geom_histogram(binwidth = 1)
```

## Histogram for total score on openness to experiences: 

```{r plots}
ggplot(green_data_rescaled) + 
  aes (x = open_total_pomp) +
  geom_histogram(binwidth = 1)
```

## Histogram for total score on intellectual curiosity:

```{r plots}
ggplot(green_data_rescaled) + 
  aes (x = intel_total_pomp) +
  geom_histogram(binwidth = 1)
```

# 5. Make scatterplots showing the relationship between green reputation and each personality trait. Include a trend line for students and non-students. What do these plots show? 

## Scatterplot for green reputation and compassion:

```{r plots}
green_data_rescaled |>
  filter(!is.na(student)) |>
ggplot() +
  aes(x = compassion_total_pomp, y = green_total_pomp,
       fill = factor(student)) +
  geom_point() +
  geom_smooth(method = "lm")
```

## Scatterplot for green reputation and openness:

```{r plots}
green_data_rescaled |>
  filter(!is.na(student)) |>
ggplot() +
  aes(x = openness_total_pomp, y = green_total_pomp,
       fill = factor(student)) +
  geom_point() +
  geom_smooth(method = "lm")
```

## Scatterplot for green reputation and intellectual curiosity:

```{r plots}
green_data_rescaled |>
  filter(!is.na(student)) |>
ggplot() +
  aes(x = intel_total_pomp, y = green_total_pomp,
       fill = factor(student)) +
  geom_point() +
  geom_smooth(method = "lm")
```

## Answer: These scatterplots show a positive linear relationship between personality traits (compassion, openness, and intellectual curiosity) and green reputation such that as the personality scores increase, green reputation scores also increase. There does not seem to be much of a diference between students and non-students, except with intellectual curiosity the trend lines intersect. 

# 6. 
