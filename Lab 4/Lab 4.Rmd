---
title: "Lab 4"
author: "Cassandra Richardson"
date: "2/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(dplyr)
library(gapminder)

dictionary <- readr::read_csv(here::here("data", "green_dictionary.csv"))
green_data <- readr::read_csv(here::here("data", "green_data.csv")) 
```

# 1. Inspect the item responses (e.g., with graphs or by summarizing distinct values). Is there anything unusual?

```{r examining data}
View(green_data)
View(dictionary)
```

## Through looking at the scales in the dictionary, I realized that some of the variables are coded as -1, meaning that they will need to be reverse-coded before conducting analyses. 

``` {r reverse coding}
reversed <- c("green2", "comp6", "comp7", "comp8", "comp9", "comp10", "intel7", "intel8", "intel9", "intel10", "open7", "open8", "open9", "open10")

green_data_fix <- green_data |>
  mutate_all(na_if, -99)
  
green_data_recoded <- green_data_fix |>
  mutate(across(
    all_of(reversed),
    \(x) recode(x, "5" = 1, "4" = 2, "3" = 3, "2" = 4, "1" = 5, "-99" = NA_real_))) 

View(green_data_recoded)
```

# 2. Compute total scores for the four scales. 

``` {r scale scores}
summary(green_data_recoded)

green_total_scores <- green_data_recoded |>
  rowwise() |>
  mutate(
    id = id, 
    green_total = mean(c_across(green1:green5), na.rm = T),
    compassion_total = mean(c_across(comp1:comp10), na.rm = T),
    openness_total = mean(c_across(open1:open10), na.rm = T),
    intel_total = mean(c_across(intel1:intel10), na.rm = T),
    .before = everything())
```
# 3. Rescale variables to be 0-100 instead of original scales. Name these variables *_pomp

```{r rescale}
green_data_rescaled <- green_total_scores |>
  mutate(
    across(green_total:intel_total,
    \(x) 100 * (x-1)/(5-1),
    .names = "{.col}_pomp"), 
    .before = everything())
```

# 4. Make plots for the distributions of the 4 pomp-scored variables

```{r plots}


```
